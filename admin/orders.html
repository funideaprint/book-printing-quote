<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>è¨‚å–®è¨˜éŒ„ç®¡ç†</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <h1>ğŸ“¦ è¨‚å–®è¨˜éŒ„</h1>

  <table border="1" cellpadding="8">
    <thead>
      <tr>
        <th>ä¸‹å–®æ™‚é–“</th>
        <th>æ‰‹å†Šåç¨±</th>
        <th>å…¬å¸åç¨±</th>
        <th>æ•¸é‡</th>
        <th>ç¸½åƒ¹</th>
        <th>è©³ç´°å…§å®¹</th>
      </tr>
    </thead>
    <tbody id="ordersTable">
      <tr><td colspan="6">è¼‰å…¥ä¸­...</td></tr>
    </tbody>
  </table>

  <script>
    async function loadOrders() {
      try {
        const res = await fetch('/api/admin/orders');
        const orders = await res.json();
        const tbody = document.getElementById('ordersTable');

        if (orders.length === 0) {
          tbody.innerHTML = '<tr><td colspan="6">ç›®å‰æ²’æœ‰è¨‚å–®ç´€éŒ„</td></tr>';
          return;
        }

        tbody.innerHTML = '';
        orders.forEach(order => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${new Date(order.createdAt).toLocaleString()}</td>
            <td>${order.manualName}</td>
            <td>${order.companyName}</td>
            <td>${order.quantity}</td>
            <td>${order.totalPrice || 'æœªå„²å­˜'}</td>
            <td>
              <details>
                <summary>æŸ¥çœ‹</summary>
                <pre>${JSON.stringify(order, null, 2)}</pre>
              </details>
            </td>
          `;
          tbody.appendChild(tr);
        });
      } catch (err) {
        document.getElementById('ordersTable').innerHTML = `<tr><td colspan="6">è¼‰å…¥å¤±æ•—</td></tr>`;
        console.error(err);
      }
    }

    loadOrders();
  </script>
</body>
</html>
